[{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"what-this-package-does","dir":"","previous_headings":"","what":"What This Package Does","title":"CLAUDE.md","text":"LODopt R package testing associations cell type abundances experimental conditions single-cell data. estimates optimal sample-specific normalization factors (account tissue size differences) via constrained optimization, fits Generalized Linear Mixed Effects Models (GLMMs) log-odds-transformed counts detect differential abundance across conditions.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"common-commands","dir":"","previous_headings":"","what":"Common Commands","title":"CLAUDE.md","text":"","code":"# Install package locally (from repo root) devtools::install()  # Run all tests devtools::test()  # Run a single test file testthat::test_file(\"tests/testthat/test_LODopt.R\")  # Regenerate documentation from roxygen2 comments devtools::document()  # Check package (runs R CMD check) devtools::check()  # Build pkgdown site (outputs to docs/) pkgdown::build_site()  # Build vignettes devtools::build_vignettes()"},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"architecture","dir":"","previous_headings":"","what":"Architecture","title":"CLAUDE.md","text":"standard R package (R/, man/, tests/, vignettes/). Source code lives three files: R/main_functions.R — Contains four core exported functions: logodds_optimized_normFactors() — Primary entry point. Takes SummarizedExperiment object, validates input, optimizes normalization factors via Rsolnp::solnp() (auto-retry convergence failure), fits per-cluster GLMMs (lme4::glmer) tryCatch error handling iterative loop identifies significantly changed clusters re-optimizes excluding convergence (max 10 iterations). Returns results BH-adjusted p-values. Supports verbose parameter accepts character names coef_of_interest_index unchanged_cluster_indices. simulate_cellCounts_fromTissue() — Simulates tissue-level cell counts using negative binomial distributions, downsamples via multinomial mimic single-cell assay counts. Used testing benchmarking. estimate_variance_w_args() — Objective function optimizer: computes total variance log-odds across specified clusters. Accepts optional precomputed centering matrix performance. ineqfun_data() — Inequality constraint function optimizer: ensures normalized total cells per sample remain feasible. R/seurat_utils.R — Contains prepare_from_seurat(), helper converts Seurat object SummarizedExperiment ready logodds_optimized_normFactors(). Seurat/SeuratObject soft dependencies (Suggests). R/utils-pipe.R — Re-exports magrittr %>% pipe operator.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"key-data-flow","dir":"","previous_headings":"Architecture","what":"Key Data Flow","title":"CLAUDE.md","text":"User constructs SummarizedExperiment counts assay, sample phenotype data colData, model parameters metadata (formula, coefficient index name, reference levels, seed, optional unchanged cluster indices names). Alternatively, use prepare_from_seurat() convert Seurat object. logodds_optimized_normFactors() validates input, optimizes normalization factors minimizing estimate_variance_w_args() subject ineqfun_data() constraints using Rsolnp::solnp(). Per-cluster binomial GLMMs fit using optimized normalization factors (tryCatch robustness). Results returned data frame log-odds ratios, raw p-values, BH-adjusted p-values per cluster.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"key-dependencies","dir":"","previous_headings":"Architecture","what":"Key Dependencies","title":"CLAUDE.md","text":"Bioconductor: SummarizedExperiment (input data structure) Optimization: Rsolnp (constrained nonlinear optimization) Mixed models: lme4 (GLMM fitting) Simulation: dirmult (Dirichlet-multinomial distribution) Optional: Seurat, SeuratObject (prepare_from_seurat())","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"testing","dir":"","previous_headings":"Architecture","what":"Testing","title":"CLAUDE.md","text":"Tests use testthat (edition 3) live tests/testthat/test_LODopt.R runner tests/testthat.R. Tests cover: simulation, full pipeline, input validation, name-based arguments, Seurat conversion (skipped SeuratObject installed), GLMM error handling. Full pipeline tests slow (optimization + GLMM fitting across many clusters).","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"cicd","dir":"","previous_headings":"Architecture","what":"CI/CD","title":"CLAUDE.md","text":"GitHub Actions workflow .github/workflows/R-CMD-check.yaml runs R CMD check macOS, Windows, Ubuntu R 4.4 pull requests main.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/CLAUDE.html","id":"conventions","dir":"","previous_headings":"","what":"Conventions","title":"CLAUDE.md","text":"Documentation generated via roxygen2 (#' comments R files) — edit roxygen comments, man/*.Rd files directly. docs/ directory generated pkgdown edited manually. NAMESPACE auto-generated roxygen2 (devtools::document()). Package requires R >= 4.4.0 Bioconductor packages (set via Additional_repositories DESCRIPTION). Never add Claude commit messages.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Gladstone Institutes Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/articles/intro.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to LODopt","text":"LODopt package provides tools analyzing associations cell type abundances experimental conditions single-cell RNA-seq data. First, let’s load necessary libraries:","code":"library(LODopt) library(dplyr) library(magrittr) library(SummarizedExperiment)"},{"path":[]},{"path":"https://gladstone-institutes.github.io/LODopt/articles/intro.html","id":"example-data","dir":"Articles","previous_headings":"Quick Start","what":"Example Data","title":"Introduction to LODopt","text":"simulate data 30 samples 25 clusters, 4 clusters (c0, c2, c7 c14) changed abundance.","code":"# Create example count matrix # Create test data set.seed(123) # No of clusters in single cell dataset K <- 25 # No of cells in tissue depth <- 1e9 # Total number of samples nsamp <- 30 alpha <- 10^runif(K, min = log10(0.5), max = log10(10)) p <- dirmult::rdirichlet(alpha = alpha) |> sort() p <- p[p > 0.001] p <- p / sum(p) size <- rep(10, length(p)) change_mean <- rep(1, length(p)) ## changed cluster indices change_mean[c(1, 3, 8, 15)] <- c(0.2, 2, 0.2, 2) # Simulate counts counts_res <- simulate_cellCounts_fromTissue(   props = p,   nsamp = nsamp,   depth = depth,   size = size,   change_mean = change_mean )"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/intro.html","id":"set-up-the-required-summarizedexperiment-object","dir":"Articles","previous_headings":"Quick Start","what":"Set up the required SummarizedExperiment object","title":"Introduction to LODopt","text":"","code":"counts <- counts_res$counts  pheno_data <- data.frame(   sampleID = paste0(\"S\", 1:30),   groupid = c(rep(\"group0\", 15), rep(\"group1\", 15)) ) %>%   tibble::column_to_rownames(\"sampleID\")  model_formula <- \"groupid\" cellcomp_se <- SummarizedExperiment(   assays = list(counts = counts),   colData = pheno_data,   metadata = list(     modelFormula = model_formula,     coef_of_interest_index = 2,     reference_levels_of_variables = list(c(\"groupid\", \"group0\")),     random_seed = 123456,     unchanged_cluster_indices = NULL   ) )"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/intro.html","id":"running-association-analysis","dir":"Articles","previous_headings":"Quick Start","what":"Running Association Analysis","title":"Introduction to LODopt","text":"","code":"cellcomp_res <- logodds_optimized_normFactors(cellcomp_se) #> Running iteration no. 1 #> Optimization did not converge, retrying (1/5) #> boundary (singular) fit: see help('isSingular') #> Running iteration no. 2 #> Optimization did not converge, retrying (1/5) #> Running iteration no. 3 #> Found stable solution"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/intro.html","id":"summarizing-results","dir":"Articles","previous_headings":"Quick Start","what":"Summarizing Results","title":"Introduction to LODopt","text":"estimate column log odds ratio estimates cluster-specific association groupid estimates_significance corresponding raw p-values corresponding null hypothesis log odds ratio equal 0.","code":"print(cellcomp_res$results) #>    cluster_id    comparison   estimates estimates_significance adjusted_pvalue #> 1          c0 groupidgroup1 -1.51858161           1.545083e-17    1.931353e-16 #> 2          c1 groupidgroup1 -0.17351938           2.118907e-01    6.868771e-01 #> 3          c2 groupidgroup1  0.79359832           1.520303e-09    9.501892e-09 #> 4          c3 groupidgroup1  0.04533991           7.134683e-01    8.230478e-01 #> 5          c4 groupidgroup1 -0.04270437           6.942090e-01    8.230478e-01 #> 6          c5 groupidgroup1 -0.13340942           2.472757e-01    6.868771e-01 #> 7          c6 groupidgroup1 -0.02868183           7.572040e-01    8.230478e-01 #> 8          c7 groupidgroup1 -1.75753960           2.666082e-50    6.665206e-49 #> 9          c8 groupidgroup1  0.12982573           1.820380e-01    6.868771e-01 #> 10         c9 groupidgroup1  0.14486437           2.167701e-01    6.868771e-01 #> 11        c10 groupidgroup1 -0.09198216           5.240377e-01    7.706437e-01 #> 12        c11 groupidgroup1  0.09652848           3.885101e-01    7.626061e-01 #> 13        c12 groupidgroup1  0.02899070           8.057244e-01    8.392963e-01 #> 14        c13 groupidgroup1 -0.07997610           4.571285e-01    7.626061e-01 #> 15        c14 groupidgroup1  0.68668034           7.456407e-12    6.213672e-11 #> 16        c15 groupidgroup1 -0.04694615           7.519014e-01    8.230478e-01 #> 17        c16 groupidgroup1  0.08071082           4.880679e-01    7.626061e-01 #> 18        c17 groupidgroup1 -0.12016532           3.272104e-01    7.626061e-01 #> 19        c18 groupidgroup1 -0.14102995           2.199268e-01    6.868771e-01 #> 20        c19 groupidgroup1  0.01669206           8.850909e-01    8.850909e-01 #> 21        c20 groupidgroup1  0.09026214           4.735210e-01    7.626061e-01 #> 22        c21 groupidgroup1  0.06121635           4.860588e-01    7.626061e-01 #> 23        c22 groupidgroup1  0.09901983           4.624356e-01    7.626061e-01 #> 24        c23 groupidgroup1 -0.06289889           5.943226e-01    7.820034e-01 #> 25        c24 groupidgroup1  0.08879573           5.626717e-01    7.814885e-01"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/intro.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Introduction to LODopt","text":"LODopt package provides simple interface testing associations cell type abundances experimental conditions, support multiple statistical methods comprehensive result visualization.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Seurat Workflow for LODopt","text":"Seurat object scRNA-seq analysis pipeline, LODopt provides prepare_from_seurat() convert directly SummarizedExperiment format logodds_optimized_normFactors() expects. vignette walks full workflow.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"Seurat Workflow for LODopt","text":"","code":"library(LODopt) library(SeuratObject)"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"load-built-in-example-data","dir":"Articles","previous_headings":"","what":"Load built-in example data","title":"Seurat Workflow for LODopt","text":"LODopt ships mock_seurat_data, small simulated dataset 6 cell types across 12 samples (6 control, 6 treated). Two cell types — B_cells Monocytes — differential abundance groups. list contains: counts_matrix — sparse gene--cell expression matrix cell_metadata — data frame cell_type, sample_id, group columns","code":"data(\"mock_seurat_data\") str(mock_seurat_data, max.level = 1) #> List of 2 #>  $ counts_matrix:Formal class 'dgCMatrix' [package \"Matrix\"] with 6 slots #>  $ cell_metadata:'data.frame':   13279 obs. of  3 variables:"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"create-a-seurat-object","dir":"Articles","previous_headings":"","what":"Create a Seurat object","title":"Seurat Workflow for LODopt","text":"step normally already Seurat object analysis. construct one example data: Let’s check metadata:","code":"seurat_obj <- CreateSeuratObject(   counts = mock_seurat_data$counts_matrix,   meta.data = mock_seurat_data$cell_metadata ) seurat_obj #> An object of class Seurat  #> 50 features across 13279 samples within 1 assay  #> Active assay: RNA (50 features, 0 variable features) #>  1 layer present: counts head(seurat_obj@meta.data) #>        orig.ident nCount_RNA nFeature_RNA cell_type sample_id   group #> cell_1       cell         32            8   B_cells  sample_1 control #> cell_2       cell          3            2   B_cells  sample_1 control #> cell_3       cell         24            5   B_cells  sample_1 control #> cell_4       cell         34            6   B_cells  sample_1 control #> cell_5       cell         32            7   B_cells  sample_1 control #> cell_6       cell         21            4   B_cells  sample_1 control table(seurat_obj$sample_id, seurat_obj$group) #>             #>             control treated #>   sample_1      835       0 #>   sample_10       0    1004 #>   sample_11       0    1424 #>   sample_12       0     700 #>   sample_2      894       0 #>   sample_3      870       0 #>   sample_4     1237       0 #>   sample_5      570       0 #>   sample_6     1354       0 #>   sample_7        0    1470 #>   sample_8        0    1896 #>   sample_9        0    1025"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"convert-to-summarizedexperiment","dir":"Articles","previous_headings":"","what":"Convert to SummarizedExperiment","title":"Seurat Workflow for LODopt","text":"prepare_from_seurat() handles conversion. need specify: cluster_col — metadata column cell type labels sample_col — metadata column sample identifiers pheno_cols — sample-level phenotype columns include model_formula — right-hand side model formula coef_of_interest — coefficient test (index name) reference_levels — reference level categorical variables","code":"cellcomp_se <- prepare_from_seurat(   seurat_obj,   cluster_col = \"cell_type\",   sample_col = \"sample_id\",   pheno_cols = \"group\",   model_formula = \"group\",   coef_of_interest = 2,   reference_levels = list(group = \"control\"),   random_seed = 42,   unchanged_clusters = NULL ) cellcomp_se #> class: SummarizedExperiment  #> dim: 6 12  #> metadata(5): modelFormula coef_of_interest_index #>   reference_levels_of_variables random_seed unchanged_cluster_indices #> assays(1): counts #> rownames(6): B_cells Dendritic_cells ... T_cells_CD4 T_cells_CD8 #> rowData names(0): #> colnames(12): sample_1 sample_10 ... sample_8 sample_9 #> colData names(1): group"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"run-differential-abundance-analysis","dir":"Articles","previous_headings":"","what":"Run differential abundance analysis","title":"Seurat Workflow for LODopt","text":"Now pass SummarizedExperiment logodds_optimized_normFactors():","code":"results <- logodds_optimized_normFactors(cellcomp_se) #> Running iteration no. 1 #> Running iteration no. 2 #> Found stable solution"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"examine-results","dir":"Articles","previous_headings":"","what":"Examine results","title":"Seurat Workflow for LODopt","text":"output list results (per-cluster statistics) optim_factor (estimated normalization factors). key columns : estimates — log-odds ratio cell type estimates_significance — raw p-value adjusted_pvalue — BH-adjusted p-value","code":"results$results #>        cluster_id   comparison   estimates estimates_significance #> 1         B_cells grouptreated -1.40405018           1.222965e-22 #> 2 Dendritic_cells grouptreated -0.23437437           9.607062e-02 #> 3       Monocytes grouptreated  0.87963908           2.887086e-04 #> 4        NK_cells grouptreated -0.04957772           7.023453e-01 #> 5     T_cells_CD4 grouptreated  0.17724844           1.535299e-01 #> 6     T_cells_CD8 grouptreated  0.11262103           3.598434e-01 #>   adjusted_pvalue #> 1    7.337790e-22 #> 2    1.921412e-01 #> 3    8.661258e-04 #> 4    7.023453e-01 #> 5    2.302948e-01 #> 6    4.318121e-01 results$optim_factor #>     sampleid optim.norm.factor #> 1   sample_1         0.9646303 #> 2  sample_10         0.9138434 #> 3  sample_11         1.0161021 #> 4  sample_12         1.1058483 #> 5   sample_2         1.0370502 #> 6   sample_3         1.0025196 #> 7   sample_4         0.9981553 #> 8   sample_5         0.9726147 #> 9   sample_6         1.0107198 #> 10  sample_7         0.9769640 #> 11  sample_8         1.0138792 #> 12  sample_9         0.9990960"},{"path":"https://gladstone-institutes.github.io/LODopt/articles/seurat-workflow.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Seurat Workflow for LODopt","text":"Seurat workflow straightforward: Start Seurat object containing cell type sample annotations Use prepare_from_seurat() convert SummarizedExperiment Run logodds_optimized_normFactors() test differential abundance details underlying method, see vignette(\"intro\", package = \"LODopt\").","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Reuben Thomas. Author, maintainer. Ayushi Agrawal. Author. Natalie Gill. Author. Michela Traglia. Author.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Thomas R, Agrawal , Gill N, Traglia M (2026). LODopt: Cell Type Abundance Association Analysis Single Cell Data. R package version 1.1.0, https://github.com/gladstone-institutes/LODopt.","code":"@Manual{,   title = {LODopt: Cell Type Abundance Association Analysis for Single Cell Data},   author = {Reuben Thomas and Ayushi Agrawal and Natalie Gill and Michela Traglia},   year = {2026},   note = {R package version 1.1.0},   url = {https://github.com/gladstone-institutes/LODopt}, }"},{"path":"https://gladstone-institutes.github.io/LODopt/index.html","id":"lodopt","dir":"","previous_headings":"","what":"Cell Type Abundance Association Analysis for Single Cell Data","title":"Cell Type Abundance Association Analysis for Single Cell Data","text":"Authors: Reuben Thomas, Ayushi Agrawal, Natalie Gill Michela Traglia","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/index.html","id":"background","dir":"","previous_headings":"","what":"Background","title":"Cell Type Abundance Association Analysis for Single Cell Data","text":"LODopt statistical method estimate changes absolute cell composition different cell-types tissue using single cell assay-based counts cells assigned given clusters/cell types per biological unit/sample. based optimal identification sample-specific normalization factors account input tissue size differences followed fitting Generalized Linear Mixed Effects Model (GLMM) using observed counts per sample per cluster. range scenarios inferences derived LODopt represent changes (unobserved) absolute counts different cell-types much broader available approaches. Based tests using simulated data, comparison exisiting approaches, LODOpt maintains correct Type error, minimal bias estimated parameters interest comparable statistical power.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Cell Type Abundance Association Analysis for Single Cell Data","text":"Currently way install using packagedevtools: get error message everything spelled correctly, follow steps trying :","code":"devtools::install_github(\"gladstone-institutes/LODopt\") #set config usethis::use_git_config(user.name = \"YourName\", user.email = \"your@mail.com\")  #Go to github page to generate token usethis::create_github_token()   #paste your PAT into pop-up that follows... credentials::set_github_pat()"},{"path":"https://gladstone-institutes.github.io/LODopt/index.html","id":"tutorial","dir":"","previous_headings":"","what":"Tutorial","title":"Cell Type Abundance Association Analysis for Single Cell Data","text":"tutorial introduces use LODopt R package.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/estimate_variance_w_args.html","id":null,"dir":"Reference","previous_headings":"","what":"estimate_variance_w_args — estimate_variance_w_args","title":"estimate_variance_w_args — estimate_variance_w_args","text":"Total (across specified set clusters) sample variance log odds clusters membership across samples within clusters","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/estimate_variance_w_args.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"estimate_variance_w_args — estimate_variance_w_args","text":"","code":"estimate_variance_w_args(   pars,   counts,   total_cells,   optim_clusters,   centering_matrix = NULL )"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/estimate_variance_w_args.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"estimate_variance_w_args — estimate_variance_w_args","text":"pars numeric vector length equal . samples, representing corresponding normalization factors counts cell count matrix number columns representing number samples number rows representing number cell-types clusters total_cells integer vector representing total number cells per sample optim_clusters integer vector representing indices clusters total variance calculated centering_matrix Optional precomputed centering matrix (nsamp x nsamp). NULL, computed internally.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/estimate_variance_w_args.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"estimate_variance_w_args — estimate_variance_w_args","text":"numeric value representing sum variances log odds cluster membership across clusters specified optim_clusters","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/ineqfun_data.html","id":null,"dir":"Reference","previous_headings":"","what":"ineqfun_data — ineqfun_data","title":"ineqfun_data — ineqfun_data","text":"Normalized number total cells per sample","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/ineqfun_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ineqfun_data — ineqfun_data","text":"","code":"ineqfun_data(pars, total_cells)"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/ineqfun_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ineqfun_data — ineqfun_data","text":"pars numeric vector length equal . samples, representing corresponding normalization factors total_cells integer vector representing total number cells per sample","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/ineqfun_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ineqfun_data — ineqfun_data","text":"numeric vector representing normalized number total cells per sample","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/logodds_optimized_normFactors.html","id":null,"dir":"Reference","previous_headings":"","what":"logodds_optimized_normFactors — logodds_optimized_normFactors","title":"logodds_optimized_normFactors — logodds_optimized_normFactors","text":"primary LODopt method","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/logodds_optimized_normFactors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"logodds_optimized_normFactors — logodds_optimized_normFactors","text":"","code":"logodds_optimized_normFactors(cellcomp_se, verbose = TRUE)"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/logodds_optimized_normFactors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"logodds_optimized_normFactors — logodds_optimized_normFactors","text":"cellcomp_se SummarizedExperiment object includes counts: assay named counts number cells sample clusters. counts data frame rownames set cluster names (without spaces special characters) column names representing sample names data association analyses assigned colData data frame row names column names counts data frame Five parameters assigned metadata slot modelFormula representing model tested using variable colData coef_of_interest_index representing index coefficient interest tested model reference_levels_of_variables list vectors.vector two elements - name categorical variable (column name colData) reference level set variable random_seed integer random seed unchanged_cluster_indices cluster indices clusters known change, set NULL known verbose Logical; TRUE (default), prints progress messages","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/logodds_optimized_normFactors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"logodds_optimized_normFactors — logodds_optimized_normFactors","text":"list two elements results: data frame results differential analyses 4 columns - cluster_id, comparison, estimates (log odds ratio) estimate_significance (pvalue) optim_factor: data frame columns sampleid optim.norm.factor","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/logodds_optimized_normFactors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"logodds_optimized_normFactors — logodds_optimized_normFactors","text":"","code":"# Create example data set.seed(123) # No of clusters in single cell dataset K <- 25 nsamp <- 30 alpha <- 10^runif(K, min = log10(0.5), max = log10(10)) p <- dirmult::rdirichlet(alpha = alpha) |> sort() p <- p[p > 0.001] p <- p / sum(p) size <- rep(10, length(p)) change_mean <- rep(1, length(p)) ## clusters 1, 3, 8 and 15 are changed. Clusters 1 and 8 reduce in abundance while clusters 3 and 15 increase change_mean[c(1, 3, 8, 15)] <- c(0.2, 2, 0.2, 2) depth <- 1e9 # Simulate counts counts_res <- simulate_cellCounts_fromTissue(   props = p,   nsamp = nsamp,   depth = depth,   size = size,   change_mean = change_mean ) counts <- counts_res$counts  pheno_data <- data.frame(   sampleID = paste0(\"S\", 1:30),   groupid = c(rep(\"group0\", 15), rep(\"group1\", 15)) ) require(magrittr) #> Loading required package: magrittr pheno_data %<>% tibble::column_to_rownames(\"sampleID\") require(SummarizedExperiment) #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #> Loading required package: generics #>  #> Attaching package: ‘generics’ #> The following objects are masked from ‘package:base’: #>  #>     as.difftime, as.factor, as.ordered, intersect, is.element, setdiff, #>     setequal, union #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, is.unsorted, lapply, #>     mapply, match, mget, order, paste, pmax, pmax.int, pmin, pmin.int, #>     rank, rbind, rownames, sapply, saveRDS, table, tapply, unique, #>     unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: Seqinfo #>  #> Attaching package: ‘GenomicRanges’ #> The following object is masked from ‘package:magrittr’: #>  #>     subtract #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: ‘Biobase’ #> The following object is masked from ‘package:MatrixGenerics’: #>  #>     rowMedians #> The following objects are masked from ‘package:matrixStats’: #>  #>     anyMissing, rowMedians model_formula <- \"groupid\" cellcomp_se <- SummarizedExperiment(   assays = list(counts = counts),   colData = pheno_data,   metadata = list(     modelFormula = model_formula,     coef_of_interest_index = 2,     reference_levels_of_variables = list(c(\"groupid\", \"group0\")),     random_seed = 123456,     unchanged_cluster_indices = NULL   ) ) cellcomp_res <- logodds_optimized_normFactors(cellcomp_se) #> Running iteration no. 1 #> Optimization did not converge, retrying (1/5) #> boundary (singular) fit: see help('isSingular') #> Running iteration no. 2 #> Optimization did not converge, retrying (1/5) #> Running iteration no. 3 #> Found stable solution print(cellcomp_res$results) #>    cluster_id    comparison   estimates estimates_significance adjusted_pvalue #> 1          c0 groupidgroup1 -1.51858161           1.545083e-17    1.931353e-16 #> 2          c1 groupidgroup1 -0.17351938           2.118907e-01    6.868771e-01 #> 3          c2 groupidgroup1  0.79359832           1.520303e-09    9.501892e-09 #> 4          c3 groupidgroup1  0.04533991           7.134683e-01    8.230478e-01 #> 5          c4 groupidgroup1 -0.04270437           6.942090e-01    8.230478e-01 #> 6          c5 groupidgroup1 -0.13340942           2.472757e-01    6.868771e-01 #> 7          c6 groupidgroup1 -0.02868183           7.572040e-01    8.230478e-01 #> 8          c7 groupidgroup1 -1.75753960           2.666082e-50    6.665206e-49 #> 9          c8 groupidgroup1  0.12982573           1.820380e-01    6.868771e-01 #> 10         c9 groupidgroup1  0.14486437           2.167701e-01    6.868771e-01 #> 11        c10 groupidgroup1 -0.09198216           5.240377e-01    7.706437e-01 #> 12        c11 groupidgroup1  0.09652848           3.885101e-01    7.626061e-01 #> 13        c12 groupidgroup1  0.02899070           8.057244e-01    8.392963e-01 #> 14        c13 groupidgroup1 -0.07997610           4.571285e-01    7.626061e-01 #> 15        c14 groupidgroup1  0.68668034           7.456407e-12    6.213672e-11 #> 16        c15 groupidgroup1 -0.04694615           7.519014e-01    8.230478e-01 #> 17        c16 groupidgroup1  0.08071082           4.880679e-01    7.626061e-01 #> 18        c17 groupidgroup1 -0.12016532           3.272104e-01    7.626061e-01 #> 19        c18 groupidgroup1 -0.14102995           2.199268e-01    6.868771e-01 #> 20        c19 groupidgroup1  0.01669206           8.850909e-01    8.850909e-01 #> 21        c20 groupidgroup1  0.09026214           4.735210e-01    7.626061e-01 #> 22        c21 groupidgroup1  0.06121635           4.860588e-01    7.626061e-01 #> 23        c22 groupidgroup1  0.09901983           4.624356e-01    7.626061e-01 #> 24        c23 groupidgroup1 -0.06289889           5.943226e-01    7.820034e-01 #> 25        c24 groupidgroup1  0.08879573           5.626717e-01    7.814885e-01"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/mock_seurat_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Mock single-cell data for Seurat workflow examples — mock_seurat_data","title":"Mock single-cell data for Seurat workflow examples — mock_seurat_data","text":"small simulated dataset representing post-analysis scRNA-seq data, suitable demonstrating prepare_from_seurat workflow. Generated using simulate_cellCounts_fromTissue 6 cell types, 12 samples (6 control, 6 treated), ~1500 cells total. Two cell types (B_cells Monocytes) differential abundance groups.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/mock_seurat_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mock single-cell data for Seurat workflow examples — mock_seurat_data","text":"","code":"mock_seurat_data"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/mock_seurat_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Mock single-cell data for Seurat workflow examples — mock_seurat_data","text":"list two elements: counts_matrix sparse gene--cell matrix (50 genes x ~1500 cells)     class dgCMatrix, suitable SeuratObject::CreateSeuratObject(). cell_metadata data frame one row per cell three columns: cell_type Character. Cell type label (one B_cells, T_cells_CD4,         T_cells_CD8, Monocytes, NK_cells, Dendritic_cells). sample_id Character. Sample identifier (sample_1 sample_12). group Character. Experimental group (\"control\" \"treated\"). Row names cell barcodes (cell_1, cell_2, ...).","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/mock_seurat_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Mock single-cell data for Seurat workflow examples — mock_seurat_data","text":"Simulated using data-raw/mock_seurat_data.R.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/prepare_from_seurat.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare LODopt input from a Seurat object — prepare_from_seurat","title":"Prepare LODopt input from a Seurat object — prepare_from_seurat","text":"Converts Seurat object SummarizedExperiment ready logodds_optimized_normFactors.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/prepare_from_seurat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare LODopt input from a Seurat object — prepare_from_seurat","text":"","code":"prepare_from_seurat(   seurat_obj,   cluster_col,   sample_col,   pheno_cols,   model_formula,   coef_of_interest,   reference_levels = NULL,   random_seed = 42,   unchanged_clusters = NULL,   sanitize_names = TRUE )"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/prepare_from_seurat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare LODopt input from a Seurat object — prepare_from_seurat","text":"seurat_obj Seurat object cluster_col Column meta.data cluster/cell type labels sample_col Column meta.data sample IDs pheno_cols Character vector columns meta.data phenotype data (must sample-level, cell-level) model_formula Model formula string (RHS , e.g., \"groupid\") coef_of_interest Index name coefficient interest reference_levels Named list: list(variable = reference_level) random_seed Integer random seed unchanged_clusters NULL, character/integer vector unchanged clusters sanitize_names Logical, replace spaces/special characters cluster names (default TRUE)","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/prepare_from_seurat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare LODopt input from a Seurat object — prepare_from_seurat","text":"SummarizedExperiment ready logodds_optimized_normFactors","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/simulate_cellCounts_fromTissue.html","id":null,"dir":"Reference","previous_headings":"","what":"simulate_cellCounts_fromTissue — simulate_cellCounts_fromTissue","title":"simulate_cellCounts_fromTissue — simulate_cellCounts_fromTissue","text":"Simulate single cell assay counts cell-types derived given tissue nsamp samples starting simulating tissue level counts downsampling obtain single cell assay counts","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/simulate_cellCounts_fromTissue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"simulate_cellCounts_fromTissue — simulate_cellCounts_fromTissue","text":"","code":"simulate_cellCounts_fromTissue(   props,   nsamp,   size = NULL,   depth = 1e+09,   change_mean )"},{"path":"https://gladstone-institutes.github.io/LODopt/reference/simulate_cellCounts_fromTissue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"simulate_cellCounts_fromTissue — simulate_cellCounts_fromTissue","text":"props vector proportions cell-types tissue. Values positive add 1. nsamp integer representing number samples size numeric negative binomial distribution parameter representing biological coefficient variation cell counts tissue depth Expected number cells tissue (default = 1e9) change_mean positive numeric vector size proportion representing change proportion individual cell-types. value 1 implies change, value less 1 implies depletion values 1 represent increase number associated cell-type","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/simulate_cellCounts_fromTissue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"simulate_cellCounts_fromTissue — simulate_cellCounts_fromTissue","text":"list following elements: counts: count matrix rows corresponding clusters nsamp columns observed_log_odds_ratios: observed log odds ratios based simulated tissue level counts theoretical_log_odds_ratios: theoretical log odds ratios based provided parameters theoretical_log_absolute_abundance_ratios: theoretical log absolute abundance ratios based provided parameters observed_log_absolute_abundance_ratios: observed log absolute abundance ratios based simulated tissue level counts","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/reference/simulate_cellCounts_fromTissue.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"simulate_cellCounts_fromTissue — simulate_cellCounts_fromTissue","text":"","code":"# Create example data set.seed(123) # No of clusters in single cell dataset K <- 25 nsamp <- 30 alpha <- 10^runif(K, min = log10(0.5), max = log10(10)) p <- dirmult::rdirichlet(alpha = alpha) |> sort() p <- p[p > 0.001] p <- p / sum(p) size <- rep(10, length(p)) change_mean <- rep(1, length(p)) change_mean[c(1, 3, 8, 15)] <- c(0.2, 2, 0.2, 2) depth <- 1e9 # Simulate counts counts_res <- simulate_cellCounts_fromTissue(props = p, nsamp = nsamp, depth = depth, size = size, change_mean = change_mean) print(counts_res$counts[1:3, 1:3]) #>    S1 S2 S3 #> c0  7 10  6 #> c1 37 41 61 #> c2 28 29 48"},{"path":[]},{"path":"https://gladstone-institutes.github.io/LODopt/news/index.html","id":"new-features-1-1-0","dir":"Changelog","previous_headings":"","what":"New features","title":"LODopt 1.1.0","text":"Added prepare_from_seurat() converting Seurat objects directly SummarizedExperiment input (#3). coef_of_interest_index unchanged_cluster_indices now accept character names addition integer indices (#5). Added BH-adjusted p-values (adjusted_pvalue column) results (#7). Optimization automatically retries new starting values convergence failure (#8). Added verbose parameter logodds_optimized_normFactors() control progress messages. Added input validation SummarizedExperiment structure metadata fields (#4). GLMM fitting wrapped tryCatch single cluster failure longer aborts full analysis. Added built-mock_seurat_data example dataset Seurat workflow vignette.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/news/index.html","id":"bug-fixes-1-1-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"LODopt 1.1.0","text":"Fixed operator precedence bug simulate_cellCounts_fromTissue() produce incorrect tissue-level counts. Fixed return value documentation mismatches (#6).","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/news/index.html","id":"performance-1-1-0","dir":"Changelog","previous_headings":"","what":"Performance","title":"LODopt 1.1.0","text":"Precompute centering matrix estimate_variance_w_args() avoid redundant allocation optimization.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/news/index.html","id":"infrastructure-1-1-0","dir":"Changelog","previous_headings":"","what":"Infrastructure","title":"LODopt 1.1.0","text":"Added CI/CD workflow (GitHub Actions R CMD check macOS, Windows, Ubuntu). Added testthat test suite broad coverage. Cleaned DESCRIPTION dependencies.","code":""},{"path":"https://gladstone-institutes.github.io/LODopt/news/index.html","id":"lodopt-100","dir":"Changelog","previous_headings":"","what":"LODopt 1.0.0","title":"LODopt 1.0.0","text":"Initial release.","code":""}]
